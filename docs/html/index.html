<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>AWS IoT Embedded C Device SDK: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AWS IoT Embedded C Device SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AWS IoT Embedded C Device SDK Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The AWS IoT device SDK for embedded C is a collection of C source files which can be used in embedded applications to securely connect to the <a href="http://docs.aws.amazon.com/iot/latest/developerguide/what-is-aws-iot.html">AWS IoT platform</a>. It includes transport clients <b>MQTT</b>, <b>TLS</b> implementations and examples for their use. It also supports AWS IoT specific features such as <b>Thing Shadow</b>. It is distributed in source form and intended to be built into customer firmware along with application code, other libraries and RTOS. For additional information about porting the Device SDK for embedded C onto additional platforms please refer to the <a href="https://github.com/aws/aws-iot-device-sdk-embedded-c/blob/master/PortingGuide.md/">PortingGuide</a>.</p>
<h2>Features</h2>
<p>The Device SDK simplifies access to the Pub/Sub functionality of the AWS IoT broker via MQTT and provide APIs to interact with Thing Shadows. The SDK has been tested to work with the AWS IoT platform to ensure best interoperability of a device with the AWS IoT platform.</p>
<h3>MQTT Connection</h3>
<p>The Device SDK provides functionality to create and maintain a mutually authenticated TLS connection over which it runs MQTT. This connection is used for any further publish operations and allow for subscribing to MQTT topics which will call a configurable callback function when these topics are received.</p>
<h3>Thing Shadow</h3>
<p>The Device SDK implements the specific protocol for Thing Shadows to retrieve, update and delete Thing Shadows adhering to the protocol that is implemented to ensure correct versioning and support for client tokens. It abstracts the necessary MQTT topic subscriptions by automatically subscribing to and unsubscribing from the reserved topics as needed for each API call. Inbound state change requests are automatically signalled via a configurable callback.</p>
<h2>Design Goals of this SDK</h2>
<p>The embedded C SDK was specifically designed for resource constrained devices (running on micro-controllers and RTOS).</p>
<p>Primary aspects are:</p><ul>
<li>Flexibility in picking and choosing functionality (reduce memory footprint)</li>
<li>Static memory only (no malloc’s)</li>
<li>Configurable resource usage(JSON tokens, MQTT subscription handlers, etc…)</li>
<li>Can be ported to a different RTOS, uses wrappers for OS specific functions</li>
</ul>
<p>For more information on the Architecture of the SDK refer <a href="http://aws-iot-device-sdk-embedded-c-docs.s3-website-us-east-1.amazonaws.com/index.html">here</a></p>
<h2>How to get started ?</h2>
<p>Ensure you understand the AWS IoT platform and create the necessary certificates and policies. For more information on the AWS IoT platform please visit the <a href="http://docs.aws.amazon.com/iot/latest/developerguide/iot-security-identity.html">AWS IoT developer guide</a>.</p>
<p>In order to quickly get started with the AWS IoT platform, we have ported the SDK for POSIX type Operating Systems like Ubuntu, OS X and RHEL. The SDK is configured for the mbedTLS library and can be built out of the box with <em>GCC</em> using <em>make utility</em>. The tarball can be downloaded from the below link:</p>
<ul>
<li><a href="https://s3.amazonaws.com/aws-iot-device-sdk-embedded-c/linux_mqtt_mbedtls-2.1.1.tar">mbedTLS from ARM</a></li>
</ul>
<h2>Installation</h2>
<p>This section explains the individual steps to retrieve the necessary files and be able to build your first application using the AWS IoT device SDK for embedded C.</p>
<p>Steps:</p>
<ul>
<li>Create a directory to hold your application e.g. (/home/&lt;user&gt;/aws_iot/my_app)</li>
<li>Change directory to this new directory</li>
<li>Download the SDK to device and place in the newly created directory</li>
<li>Expand the tarball (tar -xf &lt;tarball.tar&gt;). This will create the below directories:<ul>
<li><code>certs</code> - TLS certificates directory</li>
<li><code>docs</code> - SDK API and file documentation. This folder is not present on GitHub. You can access the documentation <a href="http://aws-iot-device-sdk-embedded-c-docs.s3-website-us-east-1.amazonaws.com/index.html">here</a></li>
<li><code>external_libs</code> - The mbedTLS and jsmn source files</li>
<li><code>include</code> - The AWS IoT SDK header files</li>
<li><code>platform</code> - Platform specific files for timer, TLS and threading layers</li>
<li><code>samples</code> - The sample applications</li>
<li><code>src</code> - The AWS IoT SDK source files</li>
<li><code>tests</code> - Contains tests for verifying that the SDK is functioning as expected. More information can be found https://github.com/aws/aws-iot-device-sdk-embedded-c/blob/master/tests/README.md "here"</li>
</ul>
</li>
<li>View further information on how to use the SDK in the Readme file for samples that can be found https://github.com/aws/aws-iot-device-sdk-embedded-c/blob/master/samples/README.md "here"</li>
</ul>
<p>Also, for a guided example on getting started with the Thing Shadow, visit the AWS IoT Console's <a href="https://console.aws.amazon.com/iot">Interactive Guide</a>.</p>
<h2>Porting to different platforms</h2>
<p>As Embedded devices run on different Real Time Operating Systems and TCP/IP stacks, it is one of the important design goals for the Device SDK to keep it portable. Please refer to the https://github.com/aws/aws-iot-device-sdk-embedded-C/blob/master/PortingGuide.md "porting guide" to get more information on how to make this SDK run on your devices (i.e. micro-controllers).</p>
<h2>Migrating from 1.x to 2.x</h2>
<p>The 2.x branch makes several changes to the SDK. This section provides information on what changes will be required in the client application for migrating from v1.x to 2.x.</p>
<ul>
<li>The first change is in the folder structure. Client applications using the SDK now need to keep only the certs, external_libs, include, src and platform folder in their application. The folder descriptions can be found above</li>
<li>All the SDK headers are in the <code>include</code> folder. These need to be added to the makefile as include directories</li>
<li>The source files are in the <code>src</code> folder. These need to be added to the makefile as one of the source directories</li>
<li>Similar to 1.x, the platform folder contains the platform specific headers and source files. These need to be added to the makefile as well</li>
<li>The <code>platform/threading</code> folder only needs to be added if multi-threading is required, and the <code>_ENABLE_THREAD_SUPPORT_</code> macro is defined in config</li>
<li>The list below provides a mapping for migrating from the major APIs used in 1.x to the new APIs:</li>
</ul>
<table class="doxtable">
<tr>
<th align="left">Description </th><th align="left">1.x </th><th align="left">2.x  </th></tr>
<tr>
<td align="left">Initializing the client </td><td align="left"><code>void aws_iot_mqtt_init(MQTTClient_t *pClient);</code> </td><td align="left"><code>IoT_Error_t <a class="el" href="aws__iot__mqtt__client_8c.html#af68b2c90a7ed7bb4d548e97a982846fd" title="MQTT Client Initialization Function. ">aws_iot_mqtt_init(AWS_IoT_Client *pClient, IoT_Client_Init_Params *pInitParams)</a>;</code> </td></tr>
<tr>
<td align="left">Connect </td><td align="left"><code>IoT_Error_t aws_iot_mqtt_connect(MQTTConnectParams *pParams);</code> </td><td align="left"><code>IoT_Error_t <a class="el" href="aws__iot__mqtt__client__connect_8c.html#aa379a6469c9a6aecf52d4c00a2b37567" title="MQTT Connection Function. ">aws_iot_mqtt_connect(AWS_IoT_Client *pClient, IoT_Client_Connect_Params *pConnectParams)</a>;</code> </td></tr>
<tr>
<td align="left">Subscribe </td><td align="left"><code>IoT_Error_t aws_iot_mqtt_subscribe(MQTTSubscribeParams *pParams);</code> </td><td align="left"><code>IoT_Error_t <a class="el" href="aws__iot__mqtt__client__subscribe_8c.html#a63a694874dbfe4272c658277e5adfcb5" title="Subscribe to an MQTT topic. ">aws_iot_mqtt_subscribe(AWS_IoT_Client *pClient, const char *pTopicName, uint16_t topicNameLen, QoS qos, pApplicationHandler_t pApplicationHandler, void *pApplicationHandlerData)</a>;</code> </td></tr>
<tr>
<td align="left">Unsubscribe </td><td align="left"><code>IoT_Error_t aws_iot_mqtt_unsubscribe(char *pTopic);</code> </td><td align="left"><code>IoT_Error_t <a class="el" href="aws__iot__mqtt__client__unsubscribe_8c.html#a12684226331372cb5fbc051235b28913" title="Unsubscribe to an MQTT topic. ">aws_iot_mqtt_unsubscribe(AWS_IoT_Client *pClient, const char *pTopicFilter, uint16_t topicFilterLen)</a>;</code> </td></tr>
<tr>
<td align="left">Yield </td><td align="left"><code>IoT_Error_t aws_iot_mqtt_yield(int timeout);</code> </td><td align="left"><code>IoT_Error_t <a class="el" href="aws__iot__mqtt__client__yield_8c.html#a0b638ebb7859f459be2de2fbb7419aa0" title="Yield to the MQTT client. ">aws_iot_mqtt_yield(AWS_IoT_Client *pClient, uint32_t timeout_ms)</a>;</code> </td></tr>
<tr>
<td align="left">Publish </td><td align="left"><code>IoT_Error_t aws_iot_mqtt_publish(MQTTPublishParams *pParams);</code> </td><td align="left"><code>IoT_Error_t <a class="el" href="aws__iot__mqtt__client__publish_8c.html#acfbb8ea42852aefdae444f91fdfcd26d" title="Publish an MQTT message on a topic. ">aws_iot_mqtt_publish(AWS_IoT_Client *pClient, const char *pTopicName, uint16_t topicNameLen, IoT_Publish_Message_Params *pParams)</a>;</code> </td></tr>
<tr>
<td align="left">Disconnect </td><td align="left"><code>IoT_Error_t aws_iot_mqtt_disconnect(void);</code> </td><td align="left"><code>IoT_Error_t <a class="el" href="aws__iot__mqtt__client__connect_8c.html#ab1b3a65a9d53c0689431d12f4aefbc11" title="Disconnect an MQTT Connection. ">aws_iot_mqtt_disconnect(AWS_IoT_Client *pClient)</a>;</code> </td></tr>
</table>
<p>You can find more information on how to use the new APIs in the Readme file for samples that can be found https://github.com/aws/aws-iot-device-sdk-embedded-c/blob/master/samples/README.md "here"</p>
<h2>Resources</h2>
<p><a href="http://aws-iot-device-sdk-embedded-c-docs.s3-website-us-east-1.amazonaws.com/index.html">API Documentation</a></p>
<p><a href="http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/csprd02/mqtt-v3.1.1-csprd02.html">MQTT 3.1.1 Spec</a></p>
<h2>Support</h2>
<p>If you have any technical questions about AWS IoT Device SDK, use the <a href="https://forums.aws.amazon.com/forum.jspa?forumID=210">AWS IoT forum</a>. For any other questions on AWS IoT, contact <a href="https://aws.amazon.com/contact-us/">AWS Support</a>.</p>
<h2>Sample APIs</h2>
<p>Connecting to the AWS IoT MQTT platform</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;AWS_IoT_Client client;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;rc = aws_iot_mqtt_init(&amp;client, &amp;iotInitParams);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;rc = aws_iot_mqtt_connect(&amp;client, &amp;iotConnectParams);</div>
</div><!-- fragment --><p>Subscribe to a topic</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;AWS_IoT_Client client;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;rc = aws_iot_mqtt_subscribe(&amp;client, &quot;sdkTest/sub&quot;, 11, QOS0, iot_subscribe_callback_handler, NULL);</div>
</div><!-- fragment --><p>Update Thing Shadow from a device</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;rc = aws_iot_shadow_update(&amp;mqttClient, AWS_IOT_MY_THING_NAME, pJsonDocumentBuffer, ShadowUpdateStatusCallback,</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;                            pCallbackContext, TIMEOUT_4SEC, persistenSubscription);</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
